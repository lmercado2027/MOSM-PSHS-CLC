<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
    <a href="index.html">Back to Home</a>
    <h1>Create</h1>
    Name: <input type="text" id="nameInput"><br>
    Beginning Inventory: <input type="number" id="quantityInput"><br>
    Expiration Date: <input type="text" id="dateInput"><br>
    <button type="button" class="btn btn-primary" onclick="create()">Create Batch</button>
    <script>
        let database = JSON.parse(localStorage.getItem("2027_EMR"))
        function create() {
            let name = $("#nameInput")[0].value
            for (let i = 0; i < database.batches.length; i++) {
                batch = database.batches[i]
                if (name == batch.name) {
                    alert("Item already exists. If this is intentional, please go to Home > Read > Update.")
                    return undefined
                } if (name < batch.name) {
                    database.batches.splice(i, 0, {
                        "name": name,
                        "start": Number($("#quantityInput")[0].value),
                        "expiryA": $("#dateInput")[0].value,
                        "added": 0,
                        "expiryB": "",
                        "consumed": 0,
                        "end": $("#quantityInput")[0].value
                    })
                    localStorage.setItem("2027_EMR", JSON.stringify(database))
                    return undefined
                }
            }
            database.batches.push({
                "name": name,
                "start": Number($("#quantityInput")[0].value),
                "expiryA": $("#dateInput")[0].value,
                "added": 0,
                "expiryB": "",
                "consumed": 0,
                "end": $("#quantityInput")[0].value
            })
            localStorage.setItem("2027_EMR", JSON.stringify(database))
        }
    </script>
</body>
</html>